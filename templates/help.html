{% extends "base.html" %}
{% block title %}Help - QuizWeaver{% endblock %}

{% block content %}
<h1>Help &amp; Getting Started</h1>

<div class="help-toc info-box">
    <strong>On this page:</strong>
    <a href="#understanding-ai">Understanding AI</a> |
    <a href="#workflow">Workflow Overview</a> |
    <a href="#classes">Managing Classes</a> |
    <a href="#lessons">Logging Lessons</a> |
    <a href="#quizzes">Generating Quizzes</a> |
    <a href="#provider-setup">Provider Setup</a> |
    <a href="#costs">Cost Tracking</a> |
    <a href="#tips">Tips &amp; Troubleshooting</a>
</div>

<section class="help-section" id="understanding-ai">
    <h2>Understanding AI in QuizWeaver</h2>
    <p>You do not need to be a tech expert to use AI responsibly. This section explains how QuizWeaver uses AI, what it can and cannot do, and how you stay in control.</p>

    <div class="help-accordion" id="aiLiteracyAccordion">

        <div class="help-accordion-item" data-accordion="ai-literacy">
            <button class="help-accordion-toggle" aria-expanded="false">What is generative AI?</button>
            <div class="help-accordion-body">
                <p>Generative AI is a type of software that creates new text based on patterns it learned from large amounts of existing text. When QuizWeaver generates a quiz, it sends information about your lessons to an AI model, which produces draft questions as output.</p>
                <p>Think of it like this: <strong>your lesson content goes in, the AI model processes it, and draft questions come out.</strong> The AI does not "understand" your lessons the way you do &mdash; it predicts what good quiz questions would look like based on the patterns it has seen.</p>
            </div>
        </div>

        <div class="help-accordion-item" data-accordion="ai-literacy">
            <button class="help-accordion-toggle" aria-expanded="false">Why does human review matter?</button>
            <div class="help-accordion-body">
                <p>AI-generated content is a <strong>draft, not a deliverable</strong>. AI models can produce content that sounds confident but is inaccurate, incomplete, or biased. This is sometimes called "hallucination."</p>
                <ul>
                    <li><strong>Accuracy</strong> &mdash; The AI may include facts that are wrong or slightly off. You know your content best.</li>
                    <li><strong>Bias</strong> &mdash; AI models reflect patterns from their training data, which may include cultural or demographic biases.</li>
                    <li><strong>Appropriateness</strong> &mdash; Only you know what is suitable for your specific students and classroom context.</li>
                </ul>
                <p>QuizWeaver is designed so you can edit, regenerate, or discard any AI-generated question before it reaches your students.</p>
            </div>
        </div>

        <div class="help-accordion-item" data-accordion="ai-literacy">
            <button class="help-accordion-toggle" aria-expanded="false">How QuizWeaver shows its work ("Glass Box")</button>
            <div class="help-accordion-body">
                <p>QuizWeaver is built to be transparent, not a "black box." You can always see:</p>
                <ul>
                    <li><strong>Which lessons</strong> informed the quiz &mdash; the assumed knowledge panel on each class page</li>
                    <li><strong>Which standards</strong> were targeted &mdash; SOL alignment shown on quiz detail pages</li>
                    <li><strong>Which cognitive framework</strong> was used &mdash; Bloom's Taxonomy or Webb's DOK levels on each question</li>
                    <li><strong>What the AI was asked to do</strong> &mdash; the generation parameters (question count, difficulty, grade level) are visible on every quiz</li>
                </ul>
                <p>This transparency helps you evaluate whether the AI output meets your teaching goals.</p>
            </div>
        </div>

        <div class="help-accordion-item" data-accordion="ai-literacy">
            <button class="help-accordion-toggle" aria-expanded="false">Rules the AI must follow (deterministic layers)</button>
            <div class="help-accordion-body">
                <p>Not everything in QuizWeaver is AI-generated. Important educational constraints are enforced by <strong>rules, not AI</strong>:</p>
                <ul>
                    <li><strong>Bloom's Taxonomy / Webb's DOK</strong> &mdash; Cognitive level distribution is calculated by rules, not guessed by the AI</li>
                    <li><strong>Rubric criteria</strong> &mdash; Proficiency levels (Beginning, Developing, Proficient, Advanced) follow a fixed structure</li>
                    <li><strong>Question type distribution</strong> &mdash; The mix of multiple-choice, short answer, and other types follows your settings</li>
                    <li><strong>Standards alignment</strong> &mdash; SOL standards are matched using your input, not AI interpretation</li>
                </ul>
                <p>This means the AI operates within boundaries you control. It generates content, but the structure comes from well-established educational frameworks.</p>
            </div>
        </div>

        <div class="help-accordion-item" data-accordion="ai-literacy">
            <button class="help-accordion-toggle" aria-expanded="false">Privacy: what data goes where</button>
            <div class="help-accordion-body">
                <p>QuizWeaver is designed with <strong>privacy by default</strong>:</p>
                <ul>
                    <li><strong>Your database is local</strong> &mdash; All classes, lessons, quizzes, and performance data are stored on your computer (or server) in a SQLite database. Nothing is sent to a cloud database.</li>
                    <li><strong>What is sent to the AI</strong> &mdash; When generating a quiz with a real provider, QuizWeaver sends your lesson summaries and topic lists to the AI model. No student names, grades, or personally identifiable information (PII) is ever included.</li>
                    <li><strong>Mock mode sends nothing</strong> &mdash; When using the default Mock provider, no data leaves your computer at all. It is completely offline.</li>
                </ul>
                <p>You always control whether a real AI provider is connected. By default, QuizWeaver runs in Mock mode with no external data sharing.</p>
            </div>
        </div>

        <div class="help-accordion-item" data-accordion="ai-literacy">
            <button class="help-accordion-toggle" aria-expanded="false">Understanding AI costs</button>
            <div class="help-accordion-body">
                <p>AI providers charge based on <strong>tokens</strong> &mdash; small units of text (roughly one token per word). When QuizWeaver sends your lesson content to the AI and receives questions back, both the input and output are measured in tokens.</p>
                <ul>
                    <li><strong>Mock mode is free</strong> &mdash; The default provider generates placeholder content at zero cost. Use this to explore QuizWeaver before connecting a real provider.</li>
                    <li><strong>Real providers have costs</strong> &mdash; Google Gemini, OpenAI, and other providers charge per token. QuizWeaver tracks all costs on the <a href="/costs">Costs page</a>.</li>
                    <li><strong>You approve every real call</strong> &mdash; Cost estimates are shown before generation, and you can cancel at any time.</li>
                </ul>
                <p>A typical quiz generation (20 questions) costs a few cents with most providers. The <a href="/costs">Costs page</a> shows your running total.</p>
            </div>
        </div>

    </div>

    <div class="help-sources">
        <strong>Further reading:</strong>
        <ul>
            <li><a href="https://www.unesco.org/en/articles/ai-competency-framework-teachers" target="_blank" rel="noopener">UNESCO (2024). AI Competency Framework for Teachers</a></li>
            <li><a href="https://www.ed.gov/sites/ed/files/documents/ai-report/ai-report.pdf" target="_blank" rel="noopener">U.S. Dept. of Education (2023). AI and the Future of Teaching and Learning</a></li>
            <li><a href="https://iste.org/standards/educators" target="_blank" rel="noopener">ISTE (2024). Standards for Educators</a></li>
            <li><a href="https://digitalpromise.org/2024/06/18/ai-literacy-a-framework-to-understand-evaluate-and-use-emerging-technology/" target="_blank" rel="noopener">Digital Promise (2024). AI Literacy Framework</a></li>
            <li><a href="https://www.sciencedirect.com/science/article/pii/S2666920X22000297" target="_blank" rel="noopener">Khosravi et al. (2022). Explainable AI in Education</a></li>
        </ul>
    </div>
</section>

<section class="help-section" id="workflow">
    <h2>Workflow Overview</h2>
    <p>QuizWeaver follows a three-step workflow to generate quizzes tailored to what you've actually taught:</p>
    <ol class="help-steps">
        <li>
            <strong>Create a class</strong> - Set up each class or block period with its grade level and standards.
            <a href="/classes/new">Create a class now</a>
        </li>
        <li>
            <strong>Log lessons</strong> - Record what you teach each day. Topics are auto-detected from your content.
        </li>
        <li>
            <strong>Generate quizzes</strong> - QuizWeaver uses your lesson history to create assessments that match what students have actually learned.
        </li>
    </ol>
</section>

<section class="help-section" id="classes">
    <h2>Managing Classes</h2>
    <dl class="help-dl">
        <dt>Create a class</dt>
        <dd>Go to <a href="/classes/new">Classes &gt; New Class</a>. Provide a name (required), and optionally a grade level, subject, and SOL standards.</dd>

        <dt>Edit a class</dt>
        <dd>From the class detail page, click "Edit" to update the name, grade level, subject, or standards.</dd>

        <dt>Delete a class</dt>
        <dd>From the class detail page, click "Delete". This removes the class and all its lessons. Quizzes already generated are kept.</dd>

        <dt>View class detail</dt>
        <dd>Click a class name to see its assumed knowledge (topics taught so far), lesson history, and generated quizzes.</dd>
    </dl>
</section>

<section class="help-section" id="lessons">
    <h2>Logging Lessons</h2>
    <dl class="help-dl">
        <dt>Text entry</dt>
        <dd>Describe what you taught - key concepts, activities, and topics covered. The more detail you provide, the better the generated quizzes will be.</dd>

        <dt>File upload</dt>
        <dd>You can upload a PDF or DOCX file with your lesson materials instead of typing content.</dd>

        <dt>Topic auto-detection</dt>
        <dd>Leave the Topics field blank and QuizWeaver will extract topics from your content. Or enter topics manually, separated by commas.</dd>

        <dt>Assumed knowledge</dt>
        <dd>As you log more lessons, QuizWeaver builds a picture of what students should know. This is shown on the class detail page and used during quiz generation.</dd>
    </dl>
</section>

<section class="help-section" id="quizzes">
    <h2>Generating Quizzes</h2>
    <dl class="help-dl">
        <dt>Question count</dt>
        <dd>Choose how many questions to generate (1-50). Default is 20.</dd>

        <dt>Grade level</dt>
        <dd>Pre-filled from your class settings. Used to calibrate question difficulty and vocabulary.</dd>

        <dt>SOL Standards</dt>
        <dd>Optionally target specific standards. Enter as comma-separated values (e.g., "SOL 7.1, SOL 7.2").</dd>

        <dt>Mock vs Real provider</dt>
        <dd>By default, QuizWeaver uses <strong>Mock mode</strong>, which is a demo/testing mode that returns pre-written placeholder content. Mock-generated quizzes are <em>not</em> customized to your lessons &mdash; they use generic sample questions so you can explore the interface at zero cost. To generate real, lesson-aligned quizzes, <a href="/settings">configure a real AI provider</a> in Settings.</dd>

        <dt>Quiz status</dt>
        <dd><span class="status status-generated">generated</span> = ready to review,
            <span class="status status-generating">generating</span> = in progress,
            <span class="status status-failed">failed</span> = an error occurred during generation.</dd>
    </dl>
</section>

<section class="help-section" id="provider-setup">
    <h2>Provider Setup</h2>
    <p>To generate quizzes customized to your lessons, connect a real AI provider. QuizWeaver supports several options:</p>
    <dl class="help-dl">
        <dt>Google Gemini</dt>
        <dd>Get a free API key from <a href="https://aistudio.google.com/apikey" target="_blank" rel="noopener">Google AI Studio</a>. Enter the key in <a href="/settings">Settings</a> and select the Gemini provider.</dd>

        <dt>OpenAI</dt>
        <dd>Get an API key from <a href="https://platform.openai.com/api-keys" target="_blank" rel="noopener">platform.openai.com</a>. Enter the key in <a href="/settings">Settings</a> and select the OpenAI provider.</dd>

        <dt>Local model (Ollama)</dt>
        <dd>Run a local model with Ollama or any OpenAI-compatible server. Select "OpenAI Compatible" in <a href="/settings">Settings</a> and set the Base URL (e.g., <code>http://localhost:11434/v1</code>).</dd>

        <dt>Test Connection</dt>
        <dd>After entering your provider details, use the "Test Connection" button on the <a href="/settings">Settings page</a> to verify everything works before saving.</dd>
    </dl>
</section>

<section class="help-section" id="costs">
    <h2>Cost Tracking</h2>
    <dl class="help-dl">
        <dt>What it shows</dt>
        <dd>The <a href="/costs">Costs page</a> displays your API usage, total cost, and current LLM provider.</dd>

        <dt>Mock provider = demo mode</dt>
        <dd>When using Mock mode (the default), all quiz generation is completely free. No API calls are made. However, the content is generic placeholder text, not customized to your lessons.</dd>

        <dt>Real provider costs</dt>
        <dd>If using Gemini or Vertex AI, costs are tracked per request and displayed on the costs page. You will be prompted for approval before any real API call.</dd>
    </dl>
</section>

<section class="help-section" id="tips">
    <h2>Tips &amp; Troubleshooting</h2>
    <dl class="help-dl">
        <dt>Quiz generation failed</dt>
        <dd>Check that the class has at least one lesson logged. The quiz generator needs lesson content to work with.</dd>

        <dt>Topics not detected</dt>
        <dd>Enter topics manually in the comma-separated field. Auto-detection works best with detailed, descriptive lesson content.</dd>

        <dt>Best results</dt>
        <dd>Log lessons regularly with detailed content. The more context QuizWeaver has, the better it can align quiz questions with what students actually learned.</dd>

        <dt>Multiple classes</dt>
        <dd>Each class tracks its own lessons and knowledge independently. Quizzes are generated per-class, so students in different blocks get assessments matched to their instruction.</dd>
    </dl>
</section>

{% endblock %}

{% block scripts %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    var toggles = document.querySelectorAll('.help-accordion-toggle');
    toggles.forEach(function(toggle) {
        toggle.addEventListener('click', function() {
            var item = this.parentElement;
            var isOpen = item.classList.contains('open');
            item.classList.toggle('open');
            this.setAttribute('aria-expanded', !isOpen);
        });
    });
});
</script>
{% endblock %}
